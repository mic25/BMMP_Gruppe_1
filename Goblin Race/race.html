<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Goblin Race</title>
    <!--<meta profile="http://www.w3.org/2005/10/profile"> -->
   	<link rel="shortcut icon" href="zucker.ico">
    <script src="script/createjs-2013.09.25.min.js"></script>
    
    <script src="script/preload.js"></script>
    <script src="script/key.js"></script>
    <script src="script/player.js"></script>
    <script src="script/menu.js"></script>
    <script src="script/game.js"></script>
    <script src="script/level.js"></script>
    <script src ="script/platform.js"></script>
    <script src ="script/event.js"></script>
    <script src ="script/contactListener.js"></script>
    <script src ="script/coins.js"></script>
    <script src ="script/bubble.js"></script>
    <script src ="script/candyCane.js"></script>
    <script src ="script/Box2dWeb-2.1.a.3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="default.css">
    

    <style>
        
    </style>

    <script>
        var stage, queue, ticker, controller, menu, game, controller, world, player, level, overlay, oldCanvasWidth, oldCanvasHeight,
            bg_stage, plat_stage, coin_stage, fg_stage;
        var isFlying = false;
        var isCandy = false;
        var inGame = false; var counter = 0; var time = Date.now();


        var deleteArray = [];

        var SCALE = 100.0;

        var b2d = {
            b2Vec2: Box2D.Common.Math.b2Vec2,
            b2BodyDef: Box2D.Dynamics.b2BodyDef,
            b2Body: Box2D.Dynamics.b2Body,
            b2FixtureDef: Box2D.Dynamics.b2FixtureDef,
            b2Fixture: Box2D.Dynamics.b2Fixture,
            b2World: Box2D.Dynamics.b2World,
            b2MassData: Box2D.Collision.Shapes.b2MassData,
            b2PolygonShape: Box2D.Collision.Shapes.b2PolygonShape,
            b2CircleShape: Box2D.Collision.Shapes.b2CircleShape,
            b2DebugDraw: Box2D.Dynamics.b2DebugDraw,
            b2ContactListener: Box2D.Dynamics.b2ContactListener,
        };
        

        function init() {

            stage = new createjs.Stage("canvas");
            bg_stage = new createjs.Stage("canvas21");
            fg_stage = new createjs.Stage("canvas22");
            plat_stage = new createjs.Stage("canvas3");
            coin_stage = new createjs.Stage("canvas4");

            adjustSize();

            /*window.onresize = function(){
                adjustSize();
            }*/

            menu = new Menu();
            ticker = createjs.Ticker.setFPS(30);
            createjs.Ticker.addEventListener("tick", tick);
            preload();

            window.addEventListener('keyup', function(event) { Key.onKeyup(event); }, false);
            window.addEventListener('keydown', function(event) { Key.onKeydown(event); }, false);
            createjs.Touch.enable(stage);   
            stage.enableMouseOver(10);     
        }

        function tick() {
            if (inGame) {
                game.handleTick();
            }
            else
                menu.handleTick();
            stage.update();
            bg_stage.update();
            fg_stage.update();
            plat_stage.update();
            coin_stage.update();          
        } 

        function adjustSize(){
            var canvas = document.getElementById("canvas");
            var div = document.getElementById("container");
            oldCanvasWidth = stage.canvas.width;
            oldCanvasHeight = stage.canvas.height;
            var newWidth = 2*window.innerWidth/3;
            var newHeight = oldCanvasHeight*((2*window.innerWidth/3)/oldCanvasWidth);

            stage.canvas.setAttribute('width', newWidth);
            stage.canvas.setAttribute('height', newHeight);
            stage.scaleX = (newWidth)/oldCanvasWidth;
            stage.scaleY = (newWidth)/oldCanvasWidth;

            bg_stage.canvas.setAttribute('width', newWidth);
            bg_stage.canvas.setAttribute('height', newHeight);
            bg_stage.scaleX = (newWidth)/oldCanvasWidth;
            bg_stage.scaleY = (newWidth) / oldCanvasWidth;

            fg_stage.canvas.setAttribute('width', newWidth);
            fg_stage.canvas.setAttribute('height', newHeight);
            fg_stage.scaleX = (newWidth) / oldCanvasWidth;
            fg_stage.scaleY = (newWidth) / oldCanvasWidth;

            plat_stage.canvas.setAttribute('width', newWidth);
            plat_stage.canvas.setAttribute('height', newHeight);
            plat_stage.scaleX = (newWidth)/oldCanvasWidth;
            plat_stage.scaleY = (newWidth)/oldCanvasWidth;

            coin_stage.canvas.setAttribute('width', newWidth);
            coin_stage.canvas.setAttribute('height', newHeight);
            coin_stage.scaleX = (newWidth)/oldCanvasWidth;
            coin_stage.scaleY = (newWidth)/oldCanvasWidth;

        }  
    </script>
</meta>

<body onload="init()">

    <p> <img src="img/Schrift.png" width="35%"></p>
    <div id="container">
        <canvas width="1366" height="768" id="canvas21" style="z-index:1">You no have canvas</canvas>
        <canvas width="1366" height="768" id="canvas22" style="z-index:2">You no have canvas</canvas>
        <canvas width="1366" height="768" id="canvas3" style="z-index:3">You no have canvas</canvas>
        <canvas width="1366" height="768" id="canvas4" style="z-index:4">You no have canvas</canvas>
        <canvas width="1366" height="768" id="canvas" style="z-index:5">You no have canvas</canvas>
    </div>
	<div id="footer">
   		   <p> © 2013 – <a href="impressum.html">Impressum</a></p>
   		</div>
</body>
</html>